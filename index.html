<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>NgÆ°á»i nháº­n - XÃ¡c minh chá»¯ kÃ½ sá»‘</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f0ff;
      color: #3d0066;
      padding: 30px;
    }
    h2 {
      color: #5f00b8;
    }
    input, button {
      margin-top: 10px;
      display: block;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #9b5de5;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #7b2cbf;
    }
    pre {
      background-color: #e6d6ff;
      padding: 10px;
      border: 1px solid #b197fc;
      border-radius: 5px;
      white-space: pre-wrap;
      margin-top: 20px;
    }
  </style>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
  <h2>ğŸ” XÃ¡c minh chá»¯ kÃ½ sá»‘</h2>

  <label>ğŸ“„ File vÄƒn báº£n Ä‘Ã£ kÃ½:</label>
  <input type="file" id="signedFile">

  <label>ğŸ” File chá»¯ kÃ½ sá»‘:</label>
  <input type="file" id="signatureFile">

  <label>ğŸ”‘ KhÃ³a cÃ´ng khai (Public Key):</label>
  <input type="file" id="publicKeyFile">

  <button onclick="verifySignature()">âœ… Kiá»ƒm tra chá»¯ kÃ½</button>

  <pre id="verifyResult">Káº¿t quáº£ xÃ¡c minh sáº½ hiá»ƒn thá»‹ táº¡i Ä‘Ã¢y...</pre>

  <script>
    const socket = io();

    async function verifySignature() {
      const textFile = document.getElementById('signedFile').files[0];
      const sigFile = document.getElementById('signatureFile').files[0];
      const pubKeyFile = document.getElementById('publicKeyFile').files[0];

      if (!textFile || !sigFile || !pubKeyFile) {
        alert("Vui lÃ²ng chá»n Ä‘áº§y Ä‘á»§ cáº£ 3 file: vÄƒn báº£n, chá»¯ kÃ½ vÃ  khÃ³a cÃ´ng khai.");
        return;
      }

      const text = await textFile.text();
      const signature = await sigFile.text();
      const pubKey = await pubKeyFile.text();

      socket.emit('verify_signature', {
        message: text,
        signature: signature,
        public_key: pubKey
      });
    }

    socket.on('verify_result', data => {
      document.getElementById('verifyResult').textContent = data.verified
        ? "âœ… Chá»¯ kÃ½ há»£p lá»‡ - VÄƒn báº£n khÃ´ng bá»‹ chá»‰nh sá»­a."
        : "âŒ Chá»¯ kÃ½ khÃ´ng há»£p lá»‡ hoáº·c vÄƒn báº£n Ä‘Ã£ bá»‹ thay Ä‘á»•i.";
    });
  </script>
</body>
</html>
